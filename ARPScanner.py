#!/usr/bin/env python3

#by C0ldheim

#Import Scapy
from scapy.all import *
import argparse


L2Broadcast = "FF:FF:FF:FF:FF:FF"

def get_arguments():
    parser = argparse.ArgumentParser()
    parser.add_argument("-t","--target", dest="target", help="Your network target")
    parser.add_argument("-i","--interface", dest="iface", help="Your network interface")
    options = parser.parse_args()
    if not options.target:
        parser.error("Error. Please, specify your target")
    if not options.iface:
        parser.error("Error. Please, specify your interface to attack")
    return options


def arpscan(target,iface):
    frame = Ether(dst=L2Broadcast, type=0x0806)
    frame /= ARP(pdst=options.target)
    answered_list = srp(frame, iface=options.iface, timeout=1, verbose=0)[0]
    for send,recive in answered_list:
        print (recive.sprintf(r"%Ether.src% - %ARP.psrc%"))
    



options = get_arguments()
arpscan(options.target, options.iface)